version: 2

sources:
  - name: external_reference
    description: External data sources (assumed valid and clean)
    tables:
      - name: episodes
        description: Raw podcast episode data from CSV files
        config:
          external_location: "read_csv('{{ var(\"data_load_path\") }}/episodes_*.csv', header=true, auto_detect=false, columns={'episode_id': 'VARCHAR', 'podcast_id': 'VARCHAR', 'title': 'VARCHAR', 'release_date': 'DATE', 'duration_seconds': 'INT'})"
          formatter: oldstyle
        columns:
          - name: episode_id
            data_type: varchar(50)
          - name: podcast_id
            data_type: varchar(50)
          - name: title
            data_type: varchar(200)
          - name: release_date
            data_type: date
          - name: duration_seconds
            data_type: integer
